<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>IBM Salesforce Context Telemetry</title>
	<link rel="icon" type="image/svg+xml" sizes="any" href="/resources/favicon.svg">
	<link rel="icon" type="image/webp" sizes="32x32" href="/resources/favicon.webp">

	<!-- Preconnect to external domains for faster loading -->
	<link rel="preconnect" href="https://cdn.jsdelivr.net">

	<!-- Preload local fonts and main stylesheet -->
	<!-- <link rel="preload" href="/fonts/inter-variable.woff2" as="font" type="font/woff2" crossorigin> -->
	<!-- <link rel="preload" href="/fonts/inter-variable.woff2" as="font" type="font/woff2" crossorigin> -->
	<link rel="preload" href="/css/output.css" as="style">
	<link rel="stylesheet" href="/css/output.css">

	<!-- Load FontAwesome -->
	<link rel="stylesheet" href="/vendor/fontawesome/css/all.min.css">
	<link rel="stylesheet" href="/vendor/fontawesome/css/v4-shims.min.css">
	<!-- Highlight.js for syntax highlighting -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/github.min.css" id="hljs-light-theme">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/atom-one-dark.min.css" id="hljs-dark-theme" media="none">
	<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js"></script>
	<script>
		// Ensure Highlight.js is available globally
		window.hljs = window.hljs || {};
	</script>
	<script src="/js/polyfills.js" defer></script>
	<script src="https://cdn.jsdelivr.net/npm/@tailwindplus/elements@1" type="module" defer></script>
	<script>
		// Apply theme immediately before page render to prevent flash
		(function () {
			const savedTheme = localStorage.getItem('theme');
			const theme = savedTheme || 'light';
			if (theme === 'dark') {
				document.documentElement.classList.add('dark');
			}
			// Don't make container visible here - wait for chart to render
			// The container will be made visible when chart animation completes
			// Fallback: if chart doesn't load within 5 seconds, show page anyway
			setTimeout(() => {
				const container = document.querySelector('.container');
				if (container) {
					const computedStyle = window.getComputedStyle(container);
					if (computedStyle.visibility === 'hidden' || computedStyle.opacity === '0') {
						container.style.visibility = 'visible';
						requestAnimationFrame(() => {
							container.style.opacity = '1';
						});
					}
				}
			}, 5000);
		})();
	</script>
	<style>
		.server-stats-gradient {
			background: linear-gradient(180deg, #ececec 0%, #e2e2e2 100%);
		}

		html.dark .server-stats-gradient {
			background: linear-gradient(135deg, #1e293b 0%, #2d3748 100%);
		}
	</style>
</head>

<body class="index-page hydrating cursor-default">
	<div class="container main-container">
		<div id="global-header-placeholder"></div>
		<script src="/js/command-palette.js" defer></script>
		<script src="/js/header.js" defer></script>
		<script>
			// Initialize header for dashboard page after scripts are parsed
			window.addEventListener('DOMContentLoaded', () => {
				initGlobalHeader();
			});
		</script>
		<div class="container-content">
			<div class="dashboard-bento-grid">
				<section class="dashboard-chart-card dashboard-card-large overflow-hidden rounded-lg bg-white dark:bg-gray-800/50 dark:outline dark:-outline-offset-1 dark:outline-white/10 shadow flex flex-col">
					<div class="chart-floating-header px-4 py-5 sm:px-6">
						<div class="chart-header" style="display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 12px;">
							<div>
								<div id="chartLegendOverlay" class="chart-legend-overlay" aria-hidden="true" data-state="empty"></div>
								<h1 class="log-viewer-title" style="margin: 0 0 4px 0;">Dashboard</h1>
							</div>
							<label class="sr-only" for="timeRangeSelect">Select date range</label>
							<div class="relative block w-full sm:w-auto sm:ml-auto">
								<select id="timeRangeSelect" name="timeRangeSelect" data-floating-interactive
										class="block appearance-none rounded-md dark:bg-white/5 py-2 pl-2 pr-12 text-xs text-gray-900 dark:text-white dark:outline-white/10">
									<option value="7">Last 7 days</option>
									<option value="14">Last 14 days</option>
									<option value="30" selected>Last month</option>
									<option value="180">Last 6 months</option>
								</select>
								<div class="absolute inset-y-0 right-0 flex items-center pr-3" style="transform: inherit;">
									<svg viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="size-5 text-gray-400">
										<path d="M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" fill-rule="evenodd" />
									</svg>
								</div>
							</div>
						</div>
					</div>
					<div class="chart-body card-body px-4 pt-0 pb-5 sm:px-6 sm:pt-0 sm:pb-6">
						<div id="eventsChart"></div>
					</div>
				</section>
				<section class="dashboard-card-small rounded-lg shadow-s bg-gray-400/10 dark:bg-gray-800/50 dark:outline dark:-outline-offset-1 dark:outline-white/10">
					<div class="px-4 py-5 sm:px-6">
						<h3 class="text-base font-semibold text-gray-900">
							Top teams
							<span class="ml-1 text-sm font-normal text-gray-500">(last 30 days)</span>
						</h3>
						<p class="mt-1 text-sm text-gray-500">Sorted by event volume across the last 30 days.</p>
					</div>
					<div class="card-body px-4 pt-0 pb-5 sm:pt-0 text-left">
						<ul id="topTeamsList" class="top-users-list">
							<li class="top-users-empty">Loading top teams…</li>
						</ul>
					</div>
				</section>
				<section class="dashboard-card-bottom rounded-lg shadow-xs bg-gray-400/10 dark:bg-gray-800/50 dark:outline dark:-outline-offset-1 dark:outline-white/10">
					<div class="px-4 py-5 sm:px-6">
						<h3 class="text-base font-semibold text-gray-900">
							Top users
							<span class="ml-1 text-sm font-normal text-gray-500">(last 14 days)</span>
						</h3>
						<p class="mt-1 text-sm text-gray-500">Sorted by event volume across the last 14 days.</p>
					</div>
					<div class="card-body px-4 pt-0 pb-5 sm:pt-0 sm:pb-6 text-left">
						<ul id="topUsersList" class="top-users-list">
							<li class="top-users-empty">Loading top users…</li>
						</ul>
					</div>
				</section>
				<section class="dashboard-card-bottom overflow-hidden rounded-lg bg-gray-50 shadow-xs outline-1 outline-gray-900/5 dark:outline dark:-outline-offset-1 dark:outline-white/10" id="serverStatsCard" style="text-align: left;">
					<div class="px-4 pt-5 pb-0 sm:px-6">
						<div class="flex items-center justify-between">
							<h3 class="text-base font-semibold text-gray-900 dark:text-white">Server stats</h3>
							<div class="flex items-center gap-2">
								<span class="text-xs font-medium text-green-700 dark:text-green-400">Connected</span>
								<div class="h-2 w-2 rounded-full bg-green-500 dark:bg-green-400"></div>
							</div>
						</div>
						<p class="mt-1 text-sm text-gray-500 dark:text-gray-400"><a href="/health" class="inline-flex items-center gap-1.5"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-4 w-4">
									<path stroke-linecap="round" stroke-linejoin="round" d="M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244" />
								</svg>View health check</a></p>
					</div>
					<dl class="flex flex-wrap px-2" style="font-size: 13.8px;">
						<div class="flex w-full flex-none gap-x-2  px-6 pt-6">
							<dt class="flex-none">
								<span class="sr-only">Uptime</span>
								<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" data-slot="icon" aria-hidden="true" class="h-[23px] w-[19px] text-gray-400 dark:text-gray-500">
									<path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z" />
								</svg>
							</dt>
							<dd class="dark:text-white">
								<span class="text-gray-500">Uptime:</span>
								<span id="serverStatsUptime">Loading...</span>
							</dd>
						</div>
						<div class="mt-3 flex w-full flex-none gap-x-2 px-6">
							<dt class="flex-none">
								<span class="sr-only">Server Version</span>
								<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" data-slot="icon" aria-hidden="true" class="h-[23px] w-[19px] text-gray-400 dark:text-gray-500">
									<path stroke-linecap="round" stroke-linejoin="round" d="M8.242 5.992h12m-12 6.003H20.24m-12 5.999h12M4.117 7.495v-3.75H2.99m1.125 3.75H2.99m1.125 0H5.24m-1.92 2.577a1.125 1.125 0 1 1 1.591 1.59l-1.83 1.83h2.16M2.99 15.745h1.125a1.125 1.125 0 0 1 0 2.25H3.74m0-.002h.375a1.125 1.125 0 0 1 0 2.25H2.99" />
								</svg>
							</dt>
							<dd>
								<span class="text-gray-500">Server Version:</span>
								<span id="serverStatsVersion">Loading...</span>
							</dd>
						</div>
						<div class="mt-3 flex w-full flex-none gap-x-2 px-6">
							<dt class="flex-none">
								<span class="sr-only">Database Status</span>
								<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" data-slot="icon" aria-hidden="true" class="h-[23px] w-[19px] text-gray-400 dark:text-gray-500">
									<path stroke-linecap="round" stroke-linejoin="round" d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125" />
								</svg>
							</dt>
							<dd>
								<span class="text-gray-500">Database Size:</span>
								<span id="serverStatsDbSize">Loading...</span>
							</dd>
						</div>
						<div class="mt-3 flex w-full flex-none gap-x-2 px-6">
							<dt class="flex-none">
								<span class="sr-only">Last Updated</span>
								<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" data-slot="icon" aria-hidden="true" class="h-[23px] w-[19px] text-gray-400 dark:text-gray-500">
									<path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
								</svg>
							</dt>
							<dd>
								<span class="text-gray-500">Last Updated:</span>
								<time id="serverStatsLastUpdated">never</time>
							</dd>
						</div>
						<div class="mt-3 flex w-full flex-none gap-x-2 px-6">
							<dt class="flex-none">
								<span class="sr-only">Load Time</span>
								<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" data-slot="icon" aria-hidden="true" class="h-[23px] w-[19px] text-gray-400 dark:text-gray-500">
									<path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" />
								</svg>
							</dt>
							<dd class>
								<span class="text-gray-500">Load Time:</span>
								<span id="serverStatsLoadTime">-</span>
							</dd>
						</div>
					</dl>

				</section>
				<section class="dashboard-card-bottom overflow-hidden rounded-lg dark:bg-gray-800/50 dark:outline dark:-outline-offset-1 dark:outline-white/10 shadow-xs" style="background: #f8f9f9;">
					<div class="px-4 pt-5 sm:px-6">
						<h3 class="text-base font-semibold text-gray-900">Tool usage</h3>
						<p class="mt-1 text-sm text-gray-500">Tool calls over the last 30 days.</p>
					</div>
					<div class="card-body px-2" style="height: 230px; filter: saturate(0.85);">
						<div id="toolUsageChart" style="width: 100%; height: 100%;"></div>
					</div>
				</section>
				<div class="dashboard-footer">
					<a href="/health" target="_blank" rel="noopener noreferrer">Health check</a> ·
					<a href="/schema" target="_blank" rel="noopener noreferrer">Schema</a> ·
					<a href="https://dashboard.render.com/" target="_blank" rel="noopener noreferrer">Render</a>
				</div>
			</div>
		</div>

		<!-- Load ECharts with defer to ensure it loads before chart initialization scripts -->
		<script src="/vendor/echarts/echarts.min.js" defer></script>
		<script src="/js/global-cache.js" defer></script>
		<script src="/js/navigation.js" defer></script>
		<script src="/js/csrf-helper.js" defer></script>
		<script src="/js/notifications.js" type="module" defer></script>
		<script type="module" src="/js/index.js" defer></script>
		<script type="module" src="/js/tool-usage-chart.js" defer></script>
		<script type="module" src="/js/user-menu.js" defer></script>
		<script type="module" src="/js/settings-modal.js" defer></script>
		<script type="module" src="/js/app.js" defer></script>
</body>

</html>